{% include 'header.html' %}
{% import 'breadcrumb/index.html' as fil %}

<div class="container-fluid">
	{{ fil.ariane(liens) }}
</div>
<div class="container-fluid">
	<div class="row-fluid">
		  <div class="span3 well well-large">
		  		<p><i class="icon-search"></i> {{"full_text_search"|trans}}</p>
		  		<p>
		  		<form class="form-search" action="/result/index">
					<input type="text" class="input-medium search-query" name="search" size="10" value="{{ searchTerms }}">
					<button type="submit" class="btn">{{"ok"|trans}}</button>
				</form>
				</p>
		  		<p><i class="icon-file"></i> {{"content_type"|trans}}</p>
		  		{% if (type == '') %}
		  		<ul>
				{% for facet in typeFacets %}
					<li><a href="{{ typeSearchRoot }}/type/{{ facet.term }}">{{ facet.term }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{type}} <a href="{{ typeSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
				<p><i class="icon-user"></i> {{"author"|trans}}</p>
		  		{% if (author == '') %}
		  		<ul>
				{% for facet in authorFacets %}
					<li><a href="{{ authorSearchRoot }}/author/{{ facet.term }}">{{ facet.term }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{author}} <a href="{{ authorSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
				<p><i class="icon-calendar"></i> {{"date"|trans}}</p>
		  		{% if (date == '') %}
		  		<ul>
				{% for facet in dateFacets %}
					<li><a href="{{ dateSearchRoot }}/date/{{ facet.time }}">{{ (facet.time/1000)|date("m/Y") }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{(date/1000)|date("m/Y")}} <a href="{{ dateSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
		</div>  		
		<div class="span9">
		{% if nbResults == 0 %}
			<div class="alert alert-error">
				{{"no_result"|trans}}
			</div>
		{% else %}
			<div class="navbar">
	  			<div class="navbar-inner">
	    			<a class="brand">{% if nbResults > 1 %}{{"there_are"|trans}}{% else %}{{"there_is"|trans}}{% endif %} <span class="badge badge-important">{{ nbResults }}</span> {% if nbResults > 1 %}{{"result_pl"|trans}}{% else %}{{"result_sg"|trans}}{% endif %}</a>
	    			<ul class="nav pull-right">
		    			<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#">
								{% if orderBy == "_score" %}
								{{"order_by_relevance"|trans}}
								{% endif %}
								{% if orderBy == "dpub" %}
							    {{"order_by_date"|trans}}
							    {% endif %}
							    {% if orderBy == "author" %}
							    {{"order_by_author"|trans}}
							    {% endif %}
							<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								{% if orderBy != "_score" %}
								<li><a href="{{ orderBySearchRoot }}/orderby/_score">{{"order_by_relevance"|trans}}</a></li>
								{% endif %}
								{% if orderBy != "dpub" %}
							    <li><a href="{{ orderBySearchRoot }}/orderby/dpub">{{"order_by_date"|trans}}</a></li>
							    {% endif %}
							    {% if orderBy != "author" %}
							    <li><a href="{{ orderBySearchRoot }}/orderby/author">{{"order_by_author"|trans}}</a></li>
							    {% endif %}
							</ul>
						</li>
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#">
						    {% if pageSize=="all" %}
						    {{"all_on_one_page"|trans}}
						    {% else %}
						    {{ pageSize }} {{"by_page"|trans}}
						    {% endif %}
						    <b class="caret"></b>
						  	</a>
						  	<ul class="dropdown-menu">
						    	<li><a href="{{ pageSizeSearchRoot }}/pagesize/10">10 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ pageSizeSearchRoot }}/pagesize/20">20 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ pageSizeSearchRoot }}/pagesize/50">50 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ pageSizeSearchRoot }}/pagesize/all">{{"all_on_one_page"|trans}}</a></li>
						  	</ul>
						</li>
					</ul>
				</div>
			</div>
			<table class="table">
				{% for result in results %}
				<tr>
					<td>
						<h3>
						<a href="{{ result.url }}">{{ result.title|highlight(searchTerms)|raw }}</a></h3> 							
						<div class="progress progress-success" style="width:50px; float: left;">
						  <div class="bar" style="width: {{ result.score*100 }}%;">{{ result.score*100 }}%</div>
						</div>
						&nbsp;<span class="label">{{ result.type|raw }}</span>
						<br />
						{{ result.description|highlight(searchTerms)|raw }}
						<br />
						{{"published_by"|trans}} <a href="#">{{ result.author|raw }}</a> {{"on"|trans}} {{ (result.dpub)|localizeddate('long', 'none', lang) }}.
					</td>
				</tr>
				{% endfor %}
			</table>
			{% if pageCount > 1 %}
			<div class="pagination pagination-centered">
			  <ul>
			  	<li class="disabled"><a href="#">Page {{ pager+1 }} sur {{ pageCount }}</a></li>
			  	{% if pager==0 %}
			  	<li class="disabled"><a href="#"><<</a></li>
			  	{% else %}
			  	<li><a href="{{ searchRoot }}/pager/{{ pager-1 }}"><<</a></li>
			  	{% endif %}
			  	{% for i in range(0, pageCount-1) %}
			    <li {% if pager==i %}class="disabled"{% endif %}><a href="{{ searchRoot }}/pager/{{ i }}">{{ i+1 }}</a></li>
			    {% endfor %}
			    {% if pager==pageCount-1 %}
			    <li class="disabled"><a href="#">>></a></li>
			    {% else %}
			    <li><a href="{{ searchRoot }}/pager/{{ pager+1 }}">>></a></li>
			    {% endif %}
			  </ul>
			</div>
			{% endif %}
		{% endif %}
	    </div>
	</div>
</div>
<hr>
{% include 'footer.html' %}
