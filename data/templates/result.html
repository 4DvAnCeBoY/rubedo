{% include 'header.html' %}
{% import 'breadcrumb/index.html' as fil %}

<div class="container-fluid">
	{{ fil.ariane(liens) }}
</div>
<div class="container-fluid">
	<div class="row-fluid">
		  <div class="span3 well well-large">
		  		<p><i class="icon-search"></i> {{"full_text_search"|trans}}</p>
		  		<p>
		  		<form class="form-search" action="/index/search">
					<input type="text" class="input-medium search-query" name="query" size="10" value="{{ search.searchTerms }}">
					<button type="submit" class="btn">{{"ok"|trans}}</button>
				</form>
				</p>
		  		<p><i class="icon-file"></i> {{"content_type"|trans}}</p>
		  		{% if (search.type == '') %}
		  		<ul>
				{% for facet in search.typeFacets %}
					<li><a href="{{ search.typeSearchRoot }}&type={{ facet.term }}">{{ facet.term }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{search.type}} <a href="{{ search.typeSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
				<p><i class="icon-user"></i> {{"author"|trans}}</p>
		  		{% if (search.author == '') %}
		  		<ul>
				{% for facet in search.authorFacets %}
					<li><a href="{{ search.authorSearchRoot }}&author={{ facet.term }}">{{ facet.term }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{search.author}} <a href="{{ search.authorSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
				<p><i class="icon-calendar"></i> {{"date"|trans}}</p>
		  		{% if (search.date == '') %}
		  		<ul>
				{% for facet in search.dateFacets %}
					<li><a href="{{ search.dateSearchRoot }}&date={{ facet.time }}">{{ (facet.time/1000)|date("Y") }} ({{ facet.count }})</a></li>
				{% endfor %}
				</ul>
				{% else %}
				<p style="padding-left: 20px">{{ (search.date/1000)|date("Y") }} <a href="{{ search.dateSearchRoot }}"><i class="icon-remove-sign"></i></a></p>
				{% endif %}
		</div>  		
		<div class="span9">
		{% if search.nbResults == 0 %}
			<div class="alert alert-error">
				{{"no_result"|trans}}
			</div>
		{% else %}
			<div class="navbar">
	  			<div class="navbar-inner">
	    			<a class="brand">{% if search.nbResults > 1 %}{{"there_are"|trans}}{% else %}{{"there_is"|trans}}{% endif %} <span class="badge badge-important">{{ search.nbResults }}</span> {% if search.nbResults > 1 %}{{"result_pl"|trans}}{% else %}{{"result_sg"|trans}}{% endif %}</a>
	    			<ul class="nav pull-right">
		    			<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#">
								{% if search.orderBy == "_score" %}
								{{"order_by_relevance"|trans}}
								{% endif %}
								{% if search.orderBy == "lastUpdateTime" %}
							    {{"order_by_date"|trans}}
							    {% endif %}
							    {% if search.orderBy == "author" %}
							    {{"order_by_author"|trans}}
							    {% endif %}
							<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								{% if search.orderBy != "_score" %}
								<li><a href="{{ search.orderBySearchRoot }}&orderby=_score">{{"order_by_relevance"|trans}}</a></li>
								{% endif %}
								{% if search.orderBy != "lastUpdateTime" %}
							    <li><a href="{{ search.orderBySearchRoot }}&orderby=lastUpdateTime">{{"order_by_date"|trans}}</a></li>
							    {% endif %}
							    {% if search.orderBy != "author" %}
							    <li><a href="{{ search.orderBySearchRoot }}&orderby=author">{{"order_by_author"|trans}}</a></li>
							    {% endif %}
							</ul>
						</li>
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#">
						    {% if search.pageSize=="all" %}
						    {{"all_on_one_page"|trans}}
						    {% else %}
						    {{ search.pageSize }} {{"by_page"|trans}}
						    {% endif %}
						    <b class="caret"></b>
						  	</a>
						  	<ul class="dropdown-menu">
						    	<li><a href="{{ search.pageSizeSearchRoot }}&pagesize=10">10 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ search.pageSizeSearchRoot }}&pagesize=20">20 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ search.pageSizeSearchRoot }}&pagesize=50">50 {{"by_page"|trans}}</a></li>
						    	<li><a href="{{ search.pageSizeSearchRoot }}&pagesize=all">{{"all_on_one_page"|trans}}</a></li>
						  	</ul>
						</li>
					</ul>
				</div>
			</div>
			<table class="table">
				{% for result in search.results %}
				<tr>
					<td>
						<h3>
						<a href="#">{{ result.title|raw }}</a></h3> 							
						<div class="progress progress-success" style="width:50px; float: left;">
						  <div class="bar" style="width: {{ result.score*100 }}%;">{{ result.score*100 }}%</div>
						</div>
						&nbsp;<span class="label">{{ result.type|raw }}</span>
						<br />
						{{ result.abstract|raw }}
						<br />
						{{"published_by"|trans}} <a href="#">{{ result.author|raw }}</a> {{"on"|trans}} {{ (result.lastUpdateTime)|localizeddate('long', 'none', lang) }}.
					</td>
				</tr>
				{% endfor %}
			</table>
			{% if search.pageCount > 1 %}
			<div class="pagination pagination-centered">
			  <ul>
			  	<li class="disabled"><a href="#">Page {{ search.pager+1 }} {{"on"|trans}} {{ search.pageCount }}</a></li>
			  	{% if search.pager==0 %}
			  	<li class="disabled"><a href="#"><<</a></li>
			  	{% else %}
			  	<li><a href="{{ search.searchRoot }}&pager={{ search.pager-1 }}"><<</a></li>
			  	{% endif %}
			  	{% for i in range(0, search.pageCount-1) %}
			    <li {% if pager==i %}class="disabled"{% endif %}><a href="{{ search.searchRoot }}&pager={{ i }}">{{ i+1 }}</a></li>
			    {% endfor %}
			    {% if search.pager==search.pageCount-1 %}
			    <li class="disabled"><a href="#">>></a></li>
			    {% else %}
			    <li><a href="{{ search.searchRoot }}&pager={{ search.pager+1 }}">>></a></li>
			    {% endif %}
			  </ul>
			</div>
			{% endif %}
		{% endif %}
	    </div>
	</div>
</div>
<hr>
{% include 'footer.html' %}
